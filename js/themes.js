// Theme definitions
export const themes = {
  warm: {
    name: 'Warm Sand',
    background: 0xf5f0e8,
    outOfBounds: 0x2a2520,
    grid: 0x8b7355,
    ripple: 0xffffff,
    palette: [
      0xe3d2b6,  // warm ochre
      0xcbbead,  // warm brown
      0xd3b19d,  // sienna
      0xe5c5a4,  // peru
      0xe7ba97,  // chocolate
      0xddc68f,  // dark goldenrod
    ]
  },
  aquatic: {
    name: 'Aquatic',
    background: 0xe8f4f5,
    outOfBounds: 0x1a2a2e,
    grid: 0x7ba3a8,
    ripple: 0xffffff,
    palette: [
      0x7eb8c9,  // deeper teal
      0xb5c9a8,  // sea moss
      0xe8c4b8,  // coral sand
      0x9ab8d8,  // soft periwinkle
      0xc9d4a8,  // kelp green
      0xd8b8c4,  // sea anemone pink
    ]
  },
  dark: {
    name: 'Midnight',
    background: 0x1e1e2e,
    outOfBounds: 0x0a0a12,
    grid: 0x4a4a6a,
    ripple: 0x6a6a8a,
    palette: [
      0x7a7a9a,  // muted lavender
      0x8a8aa8,  // dusty purple
      0x6a7a8a,  // slate
      0x9a8a9a,  // mauve
      0x7a8a8a,  // sage grey
      0x8a7a8a,  // dusty rose
    ]
  },
  blossom: {
    name: 'Blossom',
    background: 0xf8f0f4,
    outOfBounds: 0x2a2028,
    grid: 0xb89aaa,
    ripple: 0xffffff,
    palette: [
      0xe8c8d8,  // soft pink
      0xd8c0d0,  // dusty rose
      0xc8b8c8,  // lavender
      0xe0d0dc,  // pale mauve
      0xd0c8d8,  // lilac
      0xe8d8e4,  // blush
    ]
  },
  'crimson-ink': {
    name: 'Crimson Ink',
    background: 0x1a1410,
    outOfBounds: 0x0a0808,
    grid: 0x3a3430,
    ripple: 0x6a6460,
    palette: [0xe43636, 0xf6efd2, 0xe2ddb4]
  },
  orchid: {
    name: 'Orchid',
    background: 0x2a1838,
    outOfBounds: 0x140c1e,
    grid: 0x4a3858,
    ripple: 0x6a5878,
    palette: [0xffacac, 0xe45a92, 0x5d2f77, 0x3e1e68]
  },
  flamingo: {
    name: 'Flamingo',
    background: 0xfff8e8,
    outOfBounds: 0x2a2218,
    grid: 0xdaaca0,
    ripple: 0xffffff,
    palette: [0xf7418f, 0xfc819e, 0xfec7b4, 0xfff3c7]
  },
  fairy: {
    name: 'Fairy',
    background: 0xf8faf6,
    outOfBounds: 0x202822,
    grid: 0xc0c8c0,
    ripple: 0xffffff,
    palette: [0xf19ed2, 0xe8c5e5, 0x91ddcf]
  },
  rose: {
    name: 'Rose Garden',
    background: 0xfff4fc,
    outOfBounds: 0x2a1828,
    grid: 0xd8a0c0,
    ripple: 0xffffff,
    palette: [0xbe5985, 0xec7fa9, 0xffb8e0, 0xffedfa]
  },
  lavender: {
    name: 'Lavender Dream',
    background: 0xfef0f4,
    outOfBounds: 0x201828,
    grid: 0xb8a8c8,
    ripple: 0xffffff,
    palette: [0x687fe5, 0xebd6fb, 0xfeebf6, 0xfcd8cd]
  },
  coral: {
    name: 'Soft Coral',
    background: 0xfcfaf0,
    outOfBounds: 0x2a2820,
    grid: 0xc8c0b0,
    ripple: 0xffffff,
    palette: [0xffbdbd, 0xffa4a4, 0xbadfdb, 0xfcf9ea]
  },
  candy: {
    name: 'Candy',
    background: 0xf5f5f0,
    outOfBounds: 0x1a1a18,
    grid: 0xb0b0a8,
    ripple: 0xffffff,
    palette: [0xff5656, 0xffa239, 0xfeee91, 0x8ce4ff]
  },
  'neon-depths': {
    name: 'Neon Depths',
    background: 0x0e1628,
    outOfBounds: 0x060a14,
    grid: 0x2a3458,
    ripple: 0x4a5478,
    palette: [0xe94560, 0x533483, 0x0f3460, 0x16213e]
  },
  'violet-dusk': {
    name: 'Violet Dusk',
    background: 0x2e2c38,
    outOfBounds: 0x18161e,
    grid: 0x4a4854,
    ripple: 0x6a6878,
    palette: [0xf4eee0, 0x6d5d6e, 0x4f4557, 0x393646]
  },
  wine: {
    name: 'Wine',
    background: 0x2a1e36,
    outOfBounds: 0x140e1c,
    grid: 0x4a3856,
    ripple: 0x6a5876,
    palette: [0xe8bcb9, 0xae445a, 0x4b4376, 0x432e54]
  },
  ember: {
    name: 'Ember',
    background: 0x060e18,
    outOfBounds: 0x020408,
    grid: 0x1a2838,
    ripple: 0x3a4858,
    palette: [0xff6500, 0x1e3e62, 0x0b192c]
  },
  berry: {
    name: 'Berry Crush',
    background: 0x2a1230,
    outOfBounds: 0x140818,
    grid: 0x4a2850,
    ripple: 0x6a4870,
    palette: [0xd95f59, 0xc63c51, 0x8c3061, 0x522258]
  }
};

export let currentTheme = 'dark';

function isLightBackground(bgColor) {
  const r = (bgColor >> 16) & 0xff;
  const g = (bgColor >> 8) & 0xff;
  const b = bgColor & 0xff;
  return (r + g + b) / 3 > 128;
}

export function applyTheme(themeName, app, circles) {
  currentTheme = themeName;
  const theme = themes[themeName];

  // Update background
  if (app && app.renderer) {
    app.renderer.background.color = theme.background;
  }

  // Paper texture only on light backgrounds
  if (app && app._paperSprite) {
    app._paperSprite.visible = isLightBackground(theme.background);
  }

  // Update circle colors
  if (circles) {
    circles.forEach((circle, i) => {
      circle.color = theme.palette[i % theme.palette.length];
    });
  }
}

export function getTheme() {
  return themes[currentTheme];
}
